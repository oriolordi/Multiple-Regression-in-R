"0","# Feature Engineering ####"
"0","EPA$TotalServiceReviews <- EPA$PositiveServiceReview + EPA$NegativeServiceReview"
"0",""
"0","# Dummify with feature engineering"
"0","newDataFrame <- dummyVars("" ~ ."", data = EPA)"
"0","EPA_dummy <- data.frame(predict(newDataFrame, newdata = EPA))"
"0",""
"0","# Define training and testing sets ####"
"0","set.seed(107)"
"0","inTrain <- createDataPartition(y=EPA_dummy$Volume,p=0.75,list=FALSE)"
"0","training <- EPA_dummy[inTrain,]"
"0","testing <- EPA_dummy[-inTrain,]"
"0","nrow(training)"
"1","[1]"
"1"," 50"
"1","
"
"0","nrow(testing)"
"1","[1]"
"1"," 15"
"1","
"
"0","# Modelling the training data and testing with the test data ####"
"0","# Set the model training method to a 1 time repeated cross validation"
"0","ctrl <- trainControl(method = ""repeatedcv"","
"0","                     number = 10,"
"0","                     repeats = 3)"
"0","# Train the model"
"0","a <- c(""Volume ~ x4StarReviews"", ""Volume ~ x4StarReviews + PositiveServiceReview"", ""Volume ~ x4StarReviews + TotalServiceReviews"", ""Volume ~ PositiveServiceReview"")"
"0","b <- c(""knn"", ""rf"",""svmLinear"")"
"0","compare_var_mod <- c()"
"0","compare_models <- c()"
"0","for ( i in a) {"
"0","  for (j in b) {"
"0","    model <- train(formula(i), data = training, method = j, trControl = ctrl, preProcess = c('center','scale'), tuneLength = 20)"
"0","    pred <- predict(model, newdata = testing)"
"0","    pred_metric <- postResample(testing$Volume, pred)"
"0","    compare_models <- c(compare_models,model)"
"0","    compare_var_mod <- cbind(compare_var_mod , pred_metric)"
"0","  }"
"0","}"
"2","There were missing values in resampled performance measures."
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","There were missing values in resampled performance measures."
"1","note: only"
"1"," "
"1","1"
"1"," "
"1","unique complexity parameters in default grid."
"1"," "
"1","Truncating the grid to"
"1"," "
"1","1"
"1"," "
"1",".

"
"2","There were missing values in resampled performance measures."
"1","note: only"
"1"," "
"1","1"
"1"," "
"1","unique complexity parameters in default grid."
"1"," "
"1","Truncating the grid to"
"1"," "
"1","1"
"1"," "
"1",".

"
"2","There were missing values in resampled performance measures."
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"2","invalid mtry: reset to within valid range"
"0","names_var <- c()"
"0","for (i in a) {"
"0","  for(j in b) {"
"0","    names_var <- append(names_var,paste(i,j))"
"0","  }"
"0","}"
"0","colnames(compare_var_mod) <- names_var"
"0","compare_var_mod"
"1","        "
"1"," Volume ~ x4StarReviews knn"
"1"," Volume ~ x4StarReviews rf"
"1","
RMSE    "
"1","                308.6878854"
"1","               232.8134776"
"1","
Rsquared"
"1","                  0.7275657"
"1","                 0.8255693"
"1","
MAE     "
"1","                207.9627106"
"1","               158.0854728"
"1","
"
"1","        "
"1"," Volume ~ x4StarReviews svmLinear"
"1","
RMSE    "
"1","                      267.9907140"
"1","
Rsquared"
"1","                        0.7841048"
"1","
MAE     "
"1","                      142.1433361"
"1","
"
"1","        "
"1"," Volume ~ x4StarReviews + PositiveServiceReview knn"
"1","
RMSE    "
"1","                                        140.8847457"
"1","
Rsquared"
"1","                                          0.9550922"
"1","
MAE     "
"1","                                         86.9714286"
"1","
"
"1","        "
"1"," Volume ~ x4StarReviews + PositiveServiceReview rf"
"1","
RMSE    "
"1","                                       168.1760388"
"1","
Rsquared"
"1","                                         0.9071959"
"1","
MAE     "
"1","                                        98.2133092"
"1","
"
"1","        "
"1"," Volume ~ x4StarReviews + PositiveServiceReview svmLinear"
"1","
RMSE    "
"1","                                              118.3831172"
"1","
Rsquared"
"1","                                                0.9678883"
"1","
MAE     "
"1","                                               87.1450621"
"1","
"
"1","        "
"1"," Volume ~ x4StarReviews + TotalServiceReviews knn"
"1","
RMSE    "
"1","                                      136.5958212"
"1","
Rsquared"
"1","                                        0.9570008"
"1","
MAE     "
"1","                                       94.0285714"
"1","
"
"1","        "
"1"," Volume ~ x4StarReviews + TotalServiceReviews rf"
"1","
RMSE    "
"1","                                       115.11859"
"1","
Rsquared"
"1","                                         0.96383"
"1","
MAE     "
"1","                                        71.23162"
"1","
"
"1","        "
"1"," Volume ~ x4StarReviews + TotalServiceReviews svmLinear"
"1","
RMSE    "
"1","                                            178.6947234"
"1","
Rsquared"
"1","                                              0.8956365"
"1","
MAE     "
"1","                                            112.5191093"
"1","
"
"1","        "
"1"," Volume ~ PositiveServiceReview knn"
"1"," Volume ~ PositiveServiceReview rf"
"1","
RMSE    "
"1","                        119.6164519"
"1","                       155.9522975"
"1","
Rsquared"
"1","                          0.9611747"
"1","                         0.9230128"
"1","
MAE     "
"1","                         84.2226455"
"1","                        92.4343708"
"1","
"
"1","        "
"1"," Volume ~ PositiveServiceReview svmLinear"
"1","
RMSE    "
"1","                              115.9532173"
"1","
Rsquared"
"1","                                0.9594773"
"1","
MAE     "
"1","                               80.5010107"
"1","
"
"0","# Melt the error metrics"
"0","compare_var_mod_melt <- melt(compare_var_mod, varnames=c(""metric"",""model""))"
"0","compare_var_mod_melt <- as.data.frame(compare_var_mod_melt)"
"0","compare_var_mod_melt"
